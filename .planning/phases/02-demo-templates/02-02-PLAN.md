---
phase: 02-demo-templates
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/test/resources/templates/template-b.html
  - src/test/resources/css/template-b.css
  - src/test/resources/docx/template-b.docx
autonomous: true

must_haves:
  truths:
    - "Template B renders as a 1-page PDF with a working 2-column layout"
    - "Placeholders are filled with Thymeleaf th:text"
    - "2-column layout uses a table-based approach that works in CSS 2.1 paged media"
    - "A .docx source artifact exists representing the customer-provided original"
  artifacts:
    - path: "src/test/resources/templates/template-b.html"
      provides: "1-page XHTML template with 2-column table layout and Thymeleaf placeholders"
      contains: "table"
    - path: "src/test/resources/css/template-b.css"
      provides: "Print-ready CSS with @page A4, margins, table-column styling"
      contains: "@page"
    - path: "src/test/resources/docx/template-b.docx"
      provides: "Demo Word document representing customer-provided 1-page 2-column template"
  key_links:
    - from: "src/test/resources/templates/template-b.html"
      to: "src/test/resources/css/template-b.css"
      via: "link rel=stylesheet with path relative to test-classes root"
      pattern: 'href="css/template-b.css"'
---

<objective>
Create Template B: a 1-page product/service information sheet with a 2-column table-based layout, Thymeleaf placeholders, and a companion .docx source artifact.

Purpose: Proves 2-column layout rendering in OpenHTMLtoPDF using CSS 2.1 table-based approach (since CSS columns/Flexbox/Grid are not supported), completing the second demo template.
Output: template-b.html, template-b.css, template-b.docx
</objective>

<execution_context>
@/Users/markus/.claude/get-shit-done/workflows/execute-plan.md
@/Users/markus/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-pipeline/01-01-SUMMARY.md
@.planning/phases/01-foundation-pipeline/01-02-SUMMARY.md

Key patterns from Phase 1:
- XHTML compliance: all templates must be well-formed XML with self-closed void elements
- CSS link uses path relative to test-classes root: href="css/filename.css" (NOT ../css/)
- Template resolver prefix is "templates/" so template name is just "template-b" (no path, no .html)
- Font: DejaVuSans, font-family: 'DejaVuSans', sans-serif
- CSS 2.1 ONLY: no Flexbox, no Grid, no CSS columns (column-count unreliable in paged media)

Critical constraint from STATE.md:
- CSS column-count in paged media has MEDIUM confidence -- USE TABLE-BASED LAYOUT for the 2-column design
- A 2-column HTML table with `width: 100%` and two `<td>` cells at `width: 50%` is the reliable approach
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Template B HTML and CSS</name>
  <files>
    src/test/resources/templates/template-b.html
    src/test/resources/css/template-b.css
  </files>
  <action>
Create template-b.css with print-ready A4 styling:
- `@page { size: A4; margin: 2cm; }` for standard margins
- Body: `font-family: 'DejaVuSans', sans-serif; font-size: 10pt; line-height: 1.4;` (slightly smaller for info-dense layout)
- Table layout styles:
  - `.two-column-layout { width: 100%; border-collapse: collapse; }`
  - `.two-column-layout td { width: 50%; vertical-align: top; padding: 0 1cm 0 0; }` (right padding for gutter)
  - `.two-column-layout td:last-child { padding: 0 0 0 1cm; }` (left padding for right column)
  - Or use a gutter `<td>` approach with a narrow middle column
- Header area styling (company/product title, full width above columns)
- Section heading styles within columns
- List styles for bullet points if used
- Footer area styling (full width below columns)

Create template-b.html as well-formed XHTML (German product/service info sheet):
- XML declaration and proper namespaces
- CSS link: `<link rel="stylesheet" href="css/template-b.css"/>`
- **Full-width header section:**
  - Product/service title: `th:text="${title}"`
  - Subtitle/description: `th:text="${subtitle}"`
  - Horizontal rule or divider
- **2-column table layout:**
  ```xml
  <table class="two-column-layout">
    <tr>
      <td class="column-left">
        <!-- Left column content -->
      </td>
      <td class="column-right">
        <!-- Right column content -->
      </td>
    </tr>
  </table>
  ```
- **Left column — Product details:**
  - Section heading: "Produktdetails" (Product Details)
  - Product name: `th:text="${productName}"`
  - Product description: `th:text="${productDescription}"`
  - Price: `th:text="${price}"`
  - Availability: `th:text="${availability}"`
- **Right column — Contact/ordering info:**
  - Section heading: "Bestellung &amp; Kontakt" (Order & Contact)
  - Contact person: `th:text="${contactPerson}"`
  - Phone: `th:text="${phone}"`
  - Email: `th:text="${email}"`
  - Address block: `th:text="${companyAddress}"`
  - Conditional note: `<div th:if="${showSpecialOffer}"><p th:text="${specialOfferText}">Special offer</p></div>`
- **Full-width footer section:**
  - Legal text or disclaimer: `th:text="${footerText}"`
  - Company registration info (static)

Use German-language content for placeholder defaults:
- Default title: "Produktinformation"
- Default product: "Premium Dienstleistungspaket"
- All self-closing void elements
  </action>
  <verify>
Verify template is well-formed XHTML:
```bash
cd /Users/markus/Documents/git/print && xmllint --noout src/test/resources/templates/template-b.html 2>&1 || echo "XHTML validation failed"
```

Verify CSS contains @page and table styles:
```bash
grep -c "@page" src/test/resources/css/template-b.css
grep -c "two-column" src/test/resources/css/template-b.css
```

Run existing tests:
```bash
cd /Users/markus/Documents/git/print && mvn test -q 2>&1 | tail -5
```
  </verify>
  <done>
- template-b.html is well-formed XHTML with Thymeleaf placeholders
- 2-column layout uses HTML table (not CSS columns/Flexbox/Grid)
- template-b.css has @page A4 rules with table layout styles
- At least one conditional th:if block present
- Existing 9 tests still pass
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Template B .docx source artifact</name>
  <files>
    src/test/resources/docx/template-b.docx
  </files>
  <action>
Create a minimal .docx file for Template B, using the same approach chosen for Template A's .docx (either raw Open XML ZIP assembly or Apache POI).

The .docx should represent a 1-page product information sheet with 2-column layout:

1. Create the .docx containing:
   - Full-width title: "Produktinformation"
   - Full-width subtitle placeholder: `[Untertitel]`
   - A 2-column section using either:
     - Word's column layout (w:cols w:num="2") OR
     - A 2-column Word table
   - Left column placeholders: `[Produktname]`, `[Beschreibung]`, `[Preis]`, `[Verfügbarkeit]`
   - Right column placeholders: `[Kontaktperson]`, `[Telefon]`, `[E-Mail]`, `[Firmenadresse]`
   - Full-width footer: `[Rechtlicher Hinweis]`

2. Ensure the file is a valid .docx (ZIP format, openable in Word/LibreOffice)

Match the approach and tooling used in Plan 02-01 Task 2 for consistency.
  </action>
  <verify>
Verify .docx exists and is a valid ZIP:
```bash
file src/test/resources/docx/template-b.docx
unzip -t src/test/resources/docx/template-b.docx 2>&1 | head -10
```

Verify content:
```bash
unzip -p src/test/resources/docx/template-b.docx word/document.xml 2>/dev/null | head -20
```
  </verify>
  <done>
- template-b.docx exists in src/test/resources/docx/
- File is a valid .docx (ZIP containing word/document.xml)
- Document contains German placeholder text matching the HTML template structure
- Document represents a 1-page 2-column layout
  </done>
</task>

</tasks>

<verification>
1. template-b.html passes XHTML validation (xmllint --noout)
2. template-b.css contains @page, table layout rules, font-family
3. template-b.docx is a valid ZIP with word/document.xml
4. All existing tests (9) still pass: `mvn test`
5. Template B can be rendered through the pipeline (quick smoke test):
   - ThymeleafRenderer can process "template-b" without errors
   - PdfGenerator can produce a PDF from the rendered HTML
</verification>

<success_criteria>
- Template B HTML has: 2-column table layout, Thymeleaf placeholders, at least one conditional th:if block
- Template B CSS has: @page A4 with margins, table column styling, font-family DejaVuSans
- Template B .docx is a valid Word document with matching 2-column structure
- Zero test regressions
</success_criteria>

<output>
After completion, create `.planning/phases/02-demo-templates/02-02-SUMMARY.md`
</output>
